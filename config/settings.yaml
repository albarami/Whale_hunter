# V3.1 "Dark Forest" Autonomous Crypto Trading System Configuration
# Production-Ready Settings

# ============================================================================
# SYSTEM PHASE CONFIGURATION
# ============================================================================
system:
  current_phase: 0  # 0=Paper, 1=Live V2.0, 2=+Simulator, 2.5=Hybrid, 3=Full Hydra
  mode: "shadow"  # shadow, live
  chain: "solana"
  
# ============================================================================
# SIGNAL FRESHNESS BY ASSET CLASS (seconds)
# Different asset classes need different minimum token ages
# ============================================================================
signal_freshness:
  meme_coin:
    min_age_seconds: 3600  # 1 hour - high volatility, bots extract early
    max_age_hours: 48      # Ignore if older than 48h
  mid_cap:
    min_age_seconds: 1800  # 30 minutes
    max_age_hours: 72
  large_cap:
    min_age_seconds: 0     # No minimum - established tokens
    max_age_hours: 168

# Market cap thresholds for classification (USD)
market_cap_thresholds:
  large_cap_min: 100000000    # >$100M = large cap
  mid_cap_min: 10000000       # >$10M = mid cap
  # Below mid_cap = meme coin

liquidity_thresholds:
  large_cap_min: 10000000     # >$10M liquidity
  mid_cap_min: 1000000        # >$1M liquidity

# ============================================================================
# CLUSTER DEFINITIONS
# ============================================================================
clusters:
  temporal_window_seconds: 30  # Wallets acting within 30s = potential cluster
  min_cluster_size: 3          # Need 3+ wallets to form cluster
  funding_hops_max: 2          # Max hops to trace funding
  edge_decay_days: 60          # Funding edges decay over 60 days
  
# ============================================================================
# WALLET TIER SYSTEM
# ============================================================================
wallet_tiers:
  # Tier thresholds
  s_tier:
    min_wins: 5
    min_win_rate: 0.70
    min_net_pnl: 5000
    min_confidence: 0.8
  a_tier:
    min_wins: 3
    min_win_rate: 0.60
    min_net_pnl: 1000
    min_confidence: 0.6
  b_tier:
    min_wins: 2
    min_win_rate: 0.50
    min_net_pnl: 100
    min_confidence: 0.4
  c_tier:
    # Default tier for tracked wallets
    min_wins: 0
    min_confidence: 0.1

# Trust decay (30-day half-life)
trust_decay:
  half_life_days: 30
  min_wins_for_trust: 3  # Need 3+ wins before considered trustworthy
  min_cycles_for_mother: 2  # Mother wallet needs 2+ funding cycles

# ============================================================================
# CONFIDENCE THRESHOLDS
# ============================================================================
confidence:
  # Minimum confidence to execute trade
  min_trade_confidence: 0.60
  
  # Graph boost values
  graph_boost:
    s_tier_boost: 0.25   # +25% confidence for S-tier signal
    a_tier_boost: 0.15   # +15% confidence for A-tier
    b_tier_boost: 0.05   # +5% confidence for B-tier
    c_tier_boost: 0.0    # No boost for C-tier
  
  # Confidence penalties
  penalties:
    cex_funded: -0.30    # -30% if wallet is CEX funded
    stale_signal: -0.20  # -20% if signal is stale
    high_holders: -0.10  # -10% if too many holders already

# ============================================================================
# RISK LIMITS
# ============================================================================
risk:
  # Position sizing by capital tier (percentage of capital)
  position_sizing:
    capital_under_500:
      max_position_pct: 0.05     # 5% max per trade
      default_position_pct: 0.03  # 3% default
    capital_500_2000:
      max_position_pct: 0.08
      default_position_pct: 0.05
    capital_2000_5000:
      max_position_pct: 0.10
      default_position_pct: 0.07
    capital_above_5000:
      max_position_pct: 0.10
      default_position_pct: 0.08

  # Absolute limits (USD)
  absolute_limits:
    min_position_usd: 5
    max_position_usd: 500
    max_daily_loss_usd: 100
    max_weekly_loss_usd: 250

  # Drawdown triggers
  drawdown:
    warning_threshold: 0.10      # 10% drawdown = warning
    capital_preservation: 0.15   # 15% drawdown = preservation mode
    emergency_stop: 0.25         # 25% drawdown = emergency stop

  # Daily trade limits
  daily_limits:
    max_trades: 10
    max_concurrent_positions: 5

# ============================================================================
# CAPITAL PRESERVATION MODE (triggered at 15% drawdown)
# ============================================================================
capital_preservation:
  position_size_multiplier: 0.25  # Reduce positions to 25% of normal
  confidence_increase: 0.15       # Require +0.15 higher confidence
  disable_graph_signals: true     # V2.0 only
  require_manual_review: true     # Manual approval to resume
  cooldown_hours: 24              # Min 24h before resuming

# ============================================================================
# FIRST 50 TRADES SPECIAL RULES
# ============================================================================
first_50_trades:
  enabled: true
  max_position_pct: 0.03          # 3% max (not 10%)
  no_graph_boost: true            # V2.0 signals only
  mandatory_review_hours: 24      # 24h review before second trade each day
  max_trades_first_week: 5        # No more than 5 trades in week 1
  require_simulation_pass: true   # All trades must pass simulation

# ============================================================================
# SIMULATION SETTINGS
# ============================================================================
simulation:
  enabled: true
  
  # Honeypot detection
  honeypot:
    max_tax_pct: 10               # Block if tax > 10%
    test_amount_sol: 0.01         # Amount to simulate
    max_slippage_pct: 5           # Expected slippage threshold
    
  # Accuracy tracking
  accuracy:
    min_signals_for_activation: 50  # Need 50+ signals before Assassin
    min_blocker_accuracy: 0.95      # Must block 95% of losers
    
  # Loss magnitude weighting
  loss_weighting:
    rug_loss_pct: 100              # 100% loss = rug
    modest_loss_pct: 30            # 10-30% loss
    marginal_loss_pct: 5           # <5% loss
    rug_weight: 3.0                # Weight rugs 3x more
    modest_weight: 1.5             # Weight modest losses 1.5x
    marginal_weight: 1.0           # Normal weight

# ============================================================================
# ENTROPY INJECTION (Ghost Mode)
# ============================================================================
entropy:
  enabled: true
  
  # Random delay injection
  delay:
    min_ms: 5
    max_ms: 30
    
  # Probabilistic execution skipping
  skip_probability: 0.10          # Skip 10% of valid signals
  
  # Wallet rotation
  wallet_rotation:
    enabled: true
    num_wallets: 5
    
  # Position size randomization
  position_randomization:
    min_multiplier: 0.95
    max_multiplier: 1.05

# ============================================================================
# GO/NO-GO CHECKLIST (V2.5 → V3.0)
# ============================================================================
go_nogo_checklist:
  min_signals_tracked: 50
  min_simulator_accuracy: 0.95     # Block ≥95% of losers
  min_capital_usd: 5000
  min_win_rate_3_months: 0.55
  require_positive_roi: true       # After infra + tips
  rust_sidecar_health_days: 30     # Healthy for 30 days
  graph_kill_switch_tested: true

# ============================================================================
# KILL SWITCH SETTINGS
# ============================================================================
kill_switch:
  # Graph kill switch triggers
  graph:
    max_new_mothers_24h: 10        # Sudden mother explosion
    win_rate_collapse_threshold: 0.30  # Below 30%
    min_clusters_for_collapse: 3   # 3+ clusters collapsing
    observation_period_hours: 72   # 72h observation after trigger
    
  # Emergency kill switch
  emergency:
    max_consecutive_losses: 5
    max_hourly_loss_pct: 0.05      # 5% loss in 1 hour
    require_manual_restart: true

# ============================================================================
# API RATE LIMITS
# ============================================================================
api_limits:
  helius:
    requests_per_second: 10
    daily_limit: 100000
  birdeye:
    requests_per_second: 5
    daily_limit: 50000
  solscan:
    requests_per_second: 3
    daily_limit: 10000

# ============================================================================
# LOGGING
# ============================================================================
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  log_file: "logs/whale_hunter.log"
  max_file_size_mb: 50
  backup_count: 5
  log_all_signals: true
  log_simulations: true
  log_rejections: true
